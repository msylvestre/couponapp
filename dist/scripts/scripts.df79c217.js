"use strict";angular.module("BetsyApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable","LocalStorageModule"]).config(["localStorageServiceProvider",function(a){a.setPrefix("Betsy")}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/contact",{templateUrl:"views/contact.html",controller:"ContactCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("BetsyApp").controller("MainCtrl",["$scope","$http","localStorageService","CategoriesData",function(a,b,c,d){function e(){for(var b=0,c=0;c<a.items.length;c++)a.items[c].id>b&&(b=a.items[c].id);return b+1}function f(){a.getTotalItemsPrice(),a.getTotalCouponsWorth(),a.getTotalAmountToPay()}a.$watch(function(){return d.getCategories()},function(b){b&&(a.categories=b)}),a.$watch("items",function(){c.set("items",a.items),f()},!0),a.cleanForm=function(){a.id="",a.itemName="",a.itemQty="",a.itemPrice="",a.selectedCategory="",a.isTax=!1,a.couponWorth="",a.couponDouble=!1,a.couponQty="",a.itemNotes=""},a.saveItem=function(){if(void 0===a.id||""===a.id){var b={id:e(),itemName:a.itemName,itemQty:a.itemQty||0,itemPrice:a.itemPrice||0,isTax:a.isTax,couponWorth:a.couponWorth||0,couponDouble:a.couponDouble,couponQty:a.couponQty||0,couponWorthTotal:a.couponWorth*a.couponQty||0,itemNotes:a.itemNotes};a.items.push(b)}else a.items[h].itemName=a.itemName,a.items[h].itemQty=a.itemQty,a.items[h].itemPrice=a.itemPrice,a.items[h].isTax=a.isTax,a.items[h].couponWorth=a.couponWorth,a.items[h].couponDouble=a.couponDouble,a.items[h].couponQty=a.couponQty,a.items[h].couponWorthTotal=a.couponWorth*a.couponQty,a.items[h].itemNotes=a.itemNotes;a.cleanForm()},a.removeItem=function(b){a.items.splice(b,1)},a.getDetailItem=function(b){h=b,a.id=a.items[b].id,a.itemName=a.items[b].itemName,a.itemQty=a.items[b].itemQty,a.itemPrice=a.items[b].itemPrice,a.isTax=a.items[b].isTax,a.couponWorth=a.items[b].couponWorth,a.couponDouble=a.items[b].couponDouble,a.couponQty=a.items[b].couponQty,a.itemNotes=a.items[b].itemNotes},a.addTax=function(b,c){return c?b*a.taxPercentage:b},a.doubleCouponWorth=function(a,b){return b?2*a:a},a.getTotalPrice=function(){var b=a.itemQty*a.addTax(a.itemPrice,a.isTax)-a.couponQty*a.doubleCouponWorth(a.couponWorth,a.couponDouble);return b||0},a.getPricePerItem=function(){var b=(a.itemQty*a.addTax(a.itemPrice,a.isTax)-a.couponQty*a.doubleCouponWorth(a.couponWorth,a.couponDouble))/a.itemQty;return b||0},a.getTotalItemsPrice=function(){for(var b=0,c=0;c<a.items.length;c++)b+=a.addTax(a.items[c].itemQty*a.items[c].itemPrice,a.items[c].isTax);return b||0},a.getTotalCouponsWorth=function(){for(var b=0,c=0;c<a.items.length;c++)b+=a.doubleCouponWorth(a.items[c].couponWorthTotal,a.items[c].couponDouble);return a.amountToPay=a.itemsPriceTotal-a.couponsWorthTotal,b||0},a.getTotalAmountToPay=function(){return a.getTotalItemsPrice()-a.getTotalCouponsWorth()||0},a.debugButton=function(){console.log("selectedCategory : "+a.selectedCategory)},a.taxPercentage=1.14975;var g=c.get("items"),h=0;a.items=g||[],a.cleanForm(),a.getTotalItemsPrice()}]),angular.module("BetsyApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("BetsyApp").controller("ContactCtrl",["$scope",function(a){a.contact="Synergy Consultant"}]);var App=angular.module("BetsyApp");App.factory("CategoriesData",function(){var a=[];return{getCategories:function(){return a},setCategories:function(b){a=b},addCategory:function(b){a.push(b)},removeCategory:function(b){for(var c=!0,d=0;c;)a[d].id===b&&(a.splice(d,1),c=!1),d++}}}),App.controller("userCategoryCtrl",["$scope","$http","localStorageService","CategoriesData",function(a,b,c,d){a.$watch("userCategories",function(){c.set("userCategories",a.userCategories)},!0),a.cleanCategoryModal=function(){a.categoryName=null},a.removeCategory=function(b){for(var c=!0,e=0;c;)a.userCategories[e].id===b&&(a.userCategories.splice(e,1),c=!1),e++;d.removeCategory(b)},a.addCategory=function(){var b={id:a.getNextId(),categoryName:a.categoryName};console.log("cat Name: "+a.categoryName),a.userCategories.push(b),d.addCategory(b),a.cleanCategoryModal()},a.getNextId=function(){for(var b=0,c=0;c<a.userCategories.length;c++)a.userCategories[c].id>b&&(b=a.userCategories[c].id);return b+1},a.readJson=function(){b.get("data/categories.json").then(function(b){var c=b.data;a.concatCategories(c)})},a.concatCategories=function(b){var c=b.concat(a.userCategories);d.setCategories(c)};var e=c.get("userCategories");a.userCategories=e||[],a.readJson(),a.cleanCategoryModal()}]);var App=angular.module("BetsyApp");App.factory("ItemsData",function(){var a=[];return{getItems:function(){return a},setItems:function(b){a=b},addItem:function(b){a.push(b)},removeItem:function(b){for(var c=!0,d=0;c;)a[d].id===b&&(a.splice(d,1),c=!1),d++}}}),App.controller("itemCtrl",["$scope","localStorageService","ItemsData",function(){}]);